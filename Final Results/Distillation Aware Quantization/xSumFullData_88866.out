Defaulting to user installation because normal site-packages is not writeable
Requirement already satisfied: pip in /home/sshukla7/.local/lib/python3.9/site-packages (23.0.1)
Defaulting to user installation because normal site-packages is not writeable
Requirement already satisfied: transformers==4.17.0 in /home/sshukla7/.local/lib/python3.9/site-packages (from -r requirements.txt (line 1)) (4.17.0)
Requirement already satisfied: datasets==1.18.4 in /home/sshukla7/.local/lib/python3.9/site-packages (from -r requirements.txt (line 2)) (1.18.4)
Requirement already satisfied: sacrebleu==2.0 in /home/sshukla7/.local/lib/python3.9/site-packages (from -r requirements.txt (line 3)) (2.0.0)
Requirement already satisfied: wandb in /home/sshukla7/.local/lib/python3.9/site-packages (from -r requirements.txt (line 4)) (0.14.0)
Requirement already satisfied: nltk in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from -r requirements.txt (line 5)) (3.6.7)
Requirement already satisfied: accelerate==0.5.1 in /home/sshukla7/.local/lib/python3.9/site-packages (from -r requirements.txt (line 6)) (0.5.1)
Requirement already satisfied: tensorboard in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from -r requirements.txt (line 7)) (2.8.0)
Requirement already satisfied: setuptools<50 in /home/sshukla7/.local/lib/python3.9/site-packages (from -r requirements.txt (line 8)) (49.6.0)
Requirement already satisfied: rouge_score in /home/sshukla7/.local/lib/python3.9/site-packages (from -r requirements.txt (line 9)) (0.1.2)
Requirement already satisfied: requests in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from transformers==4.17.0->-r requirements.txt (line 1)) (2.27.1)
Requirement already satisfied: huggingface-hub<1.0,>=0.1.0 in /home/sshukla7/.local/lib/python3.9/site-packages (from transformers==4.17.0->-r requirements.txt (line 1)) (0.13.3)
Requirement already satisfied: tqdm>=4.27 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from transformers==4.17.0->-r requirements.txt (line 1)) (4.63.1)
Requirement already satisfied: filelock in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from transformers==4.17.0->-r requirements.txt (line 1)) (3.6.0)
Requirement already satisfied: sacremoses in /home/sshukla7/.local/lib/python3.9/site-packages (from transformers==4.17.0->-r requirements.txt (line 1)) (0.0.53)
Requirement already satisfied: pyyaml>=5.1 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from transformers==4.17.0->-r requirements.txt (line 1)) (6.0)
Requirement already satisfied: tokenizers!=0.11.3,>=0.11.1 in /home/sshukla7/.local/lib/python3.9/site-packages (from transformers==4.17.0->-r requirements.txt (line 1)) (0.13.2)
Requirement already satisfied: regex!=2019.12.17 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from transformers==4.17.0->-r requirements.txt (line 1)) (2022.3.15)
Requirement already satisfied: packaging>=20.0 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from transformers==4.17.0->-r requirements.txt (line 1)) (21.3)
Requirement already satisfied: numpy>=1.17 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from transformers==4.17.0->-r requirements.txt (line 1)) (1.22.3)
Requirement already satisfied: xxhash in /home/sshukla7/.local/lib/python3.9/site-packages (from datasets==1.18.4->-r requirements.txt (line 2)) (3.2.0)
Requirement already satisfied: pyarrow!=4.0.0,>=3.0.0 in /home/sshukla7/.local/lib/python3.9/site-packages (from datasets==1.18.4->-r requirements.txt (line 2)) (11.0.0)
Requirement already satisfied: aiohttp in /home/sshukla7/.local/lib/python3.9/site-packages (from datasets==1.18.4->-r requirements.txt (line 2)) (3.8.4)
Requirement already satisfied: fsspec[http]>=2021.05.0 in /home/sshukla7/.local/lib/python3.9/site-packages (from datasets==1.18.4->-r requirements.txt (line 2)) (2023.3.0)
Requirement already satisfied: multiprocess in /home/sshukla7/.local/lib/python3.9/site-packages (from datasets==1.18.4->-r requirements.txt (line 2)) (0.70.14)
Requirement already satisfied: dill in /home/sshukla7/.local/lib/python3.9/site-packages (from datasets==1.18.4->-r requirements.txt (line 2)) (0.3.6)
Requirement already satisfied: responses<0.19 in /home/sshukla7/.local/lib/python3.9/site-packages (from datasets==1.18.4->-r requirements.txt (line 2)) (0.18.0)
Requirement already satisfied: pandas in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from datasets==1.18.4->-r requirements.txt (line 2)) (1.3.5)
Requirement already satisfied: tabulate>=0.8.9 in /home/sshukla7/.local/lib/python3.9/site-packages (from sacrebleu==2.0->-r requirements.txt (line 3)) (0.9.0)
Requirement already satisfied: colorama in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from sacrebleu==2.0->-r requirements.txt (line 3)) (0.4.4)
Requirement already satisfied: portalocker in /home/sshukla7/.local/lib/python3.9/site-packages (from sacrebleu==2.0->-r requirements.txt (line 3)) (2.7.0)
Requirement already satisfied: torch>=1.4.0 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from accelerate==0.5.1->-r requirements.txt (line 6)) (1.12.1+cu113)
Requirement already satisfied: psutil>=5.0.0 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from wandb->-r requirements.txt (line 4)) (5.9.0)
Requirement already satisfied: appdirs>=1.4.3 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from wandb->-r requirements.txt (line 4)) (1.4.4)
Requirement already satisfied: docker-pycreds>=0.4.0 in /home/sshukla7/.local/lib/python3.9/site-packages (from wandb->-r requirements.txt (line 4)) (0.4.0)
Requirement already satisfied: setproctitle in /home/sshukla7/.local/lib/python3.9/site-packages (from wandb->-r requirements.txt (line 4)) (1.3.2)
Requirement already satisfied: pathtools in /home/sshukla7/.local/lib/python3.9/site-packages (from wandb->-r requirements.txt (line 4)) (0.1.2)
Requirement already satisfied: protobuf!=4.21.0,<5,>=3.15.0 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from wandb->-r requirements.txt (line 4)) (3.19.4)
Requirement already satisfied: Click!=8.0.0,>=7.0 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from wandb->-r requirements.txt (line 4)) (8.0.4)
Requirement already satisfied: typing-extensions in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from wandb->-r requirements.txt (line 4)) (4.1.1)
Requirement already satisfied: sentry-sdk>=1.0.0 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from wandb->-r requirements.txt (line 4)) (1.5.8)
Requirement already satisfied: GitPython!=3.1.29,>=1.0.0 in /home/sshukla7/.local/lib/python3.9/site-packages (from wandb->-r requirements.txt (line 4)) (3.1.31)
Requirement already satisfied: joblib in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from nltk->-r requirements.txt (line 5)) (1.1.0)
Requirement already satisfied: grpcio>=1.24.3 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from tensorboard->-r requirements.txt (line 7)) (1.44.0)
Requirement already satisfied: google-auth<3,>=1.6.3 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from tensorboard->-r requirements.txt (line 7)) (1.35.0)
Requirement already satisfied: tensorboard-data-server<0.7.0,>=0.6.0 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from tensorboard->-r requirements.txt (line 7)) (0.6.1)
Requirement already satisfied: markdown>=2.6.8 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from tensorboard->-r requirements.txt (line 7)) (3.3.6)
Requirement already satisfied: google-auth-oauthlib<0.5,>=0.4.1 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from tensorboard->-r requirements.txt (line 7)) (0.4.6)
Requirement already satisfied: werkzeug>=0.11.15 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from tensorboard->-r requirements.txt (line 7)) (2.0.3)
Requirement already satisfied: absl-py>=0.4 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from tensorboard->-r requirements.txt (line 7)) (1.0.0)
Requirement already satisfied: tensorboard-plugin-wit>=1.6.0 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from tensorboard->-r requirements.txt (line 7)) (1.8.1)
Requirement already satisfied: wheel>=0.26 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from tensorboard->-r requirements.txt (line 7)) (0.37.1)
Requirement already satisfied: six>=1.14.0 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from rouge_score->-r requirements.txt (line 9)) (1.16.0)
Requirement already satisfied: multidict<7.0,>=4.5 in /home/sshukla7/.local/lib/python3.9/site-packages (from aiohttp->datasets==1.18.4->-r requirements.txt (line 2)) (6.0.4)
Requirement already satisfied: charset-normalizer<4.0,>=2.0 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from aiohttp->datasets==1.18.4->-r requirements.txt (line 2)) (2.0.12)
Requirement already satisfied: aiosignal>=1.1.2 in /home/sshukla7/.local/lib/python3.9/site-packages (from aiohttp->datasets==1.18.4->-r requirements.txt (line 2)) (1.3.1)
Requirement already satisfied: frozenlist>=1.1.1 in /home/sshukla7/.local/lib/python3.9/site-packages (from aiohttp->datasets==1.18.4->-r requirements.txt (line 2)) (1.3.3)
Requirement already satisfied: async-timeout<5.0,>=4.0.0a3 in /home/sshukla7/.local/lib/python3.9/site-packages (from aiohttp->datasets==1.18.4->-r requirements.txt (line 2)) (4.0.2)
Requirement already satisfied: attrs>=17.3.0 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from aiohttp->datasets==1.18.4->-r requirements.txt (line 2)) (21.4.0)
Requirement already satisfied: yarl<2.0,>=1.0 in /home/sshukla7/.local/lib/python3.9/site-packages (from aiohttp->datasets==1.18.4->-r requirements.txt (line 2)) (1.8.2)
Requirement already satisfied: gitdb<5,>=4.0.1 in /home/sshukla7/.local/lib/python3.9/site-packages (from GitPython!=3.1.29,>=1.0.0->wandb->-r requirements.txt (line 4)) (4.0.10)
Requirement already satisfied: pyasn1-modules>=0.2.1 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from google-auth<3,>=1.6.3->tensorboard->-r requirements.txt (line 7)) (0.2.8)
Requirement already satisfied: cachetools<5.0,>=2.0.0 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from google-auth<3,>=1.6.3->tensorboard->-r requirements.txt (line 7)) (4.2.4)
Requirement already satisfied: rsa<5,>=3.1.4 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from google-auth<3,>=1.6.3->tensorboard->-r requirements.txt (line 7)) (4.8)
Requirement already satisfied: requests-oauthlib>=0.7.0 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from google-auth-oauthlib<0.5,>=0.4.1->tensorboard->-r requirements.txt (line 7)) (1.3.1)
Requirement already satisfied: importlib-metadata>=4.4 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from markdown>=2.6.8->tensorboard->-r requirements.txt (line 7)) (4.11.3)
Requirement already satisfied: pyparsing!=3.0.5,>=2.0.2 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from packaging>=20.0->transformers==4.17.0->-r requirements.txt (line 1)) (3.0.7)
Requirement already satisfied: urllib3<1.27,>=1.21.1 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from requests->transformers==4.17.0->-r requirements.txt (line 1)) (1.26.9)
Requirement already satisfied: certifi>=2017.4.17 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from requests->transformers==4.17.0->-r requirements.txt (line 1)) (2021.10.8)
Requirement already satisfied: idna<4,>=2.5 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from requests->transformers==4.17.0->-r requirements.txt (line 1)) (3.3)
Requirement already satisfied: pytz>=2017.3 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from pandas->datasets==1.18.4->-r requirements.txt (line 2)) (2019.3)
Requirement already satisfied: python-dateutil>=2.7.3 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from pandas->datasets==1.18.4->-r requirements.txt (line 2)) (2.8.1)
Requirement already satisfied: smmap<6,>=3.0.1 in /home/sshukla7/.local/lib/python3.9/site-packages (from gitdb<5,>=4.0.1->GitPython!=3.1.29,>=1.0.0->wandb->-r requirements.txt (line 4)) (5.0.0)
Requirement already satisfied: zipp>=0.5 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from importlib-metadata>=4.4->markdown>=2.6.8->tensorboard->-r requirements.txt (line 7)) (3.7.0)
Requirement already satisfied: pyasn1<0.5.0,>=0.4.6 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from pyasn1-modules>=0.2.1->google-auth<3,>=1.6.3->tensorboard->-r requirements.txt (line 7)) (0.4.8)
Requirement already satisfied: oauthlib>=3.0.0 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from requests-oauthlib>=0.7.0->google-auth-oauthlib<0.5,>=0.4.1->tensorboard->-r requirements.txt (line 7)) (3.2.0)
Defaulting to user installation because normal site-packages is not writeable
Requirement already satisfied: datasets in /home/sshukla7/.local/lib/python3.9/site-packages (1.18.4)
Requirement already satisfied: transformers in /home/sshukla7/.local/lib/python3.9/site-packages (4.17.0)
Requirement already satisfied: accelerate in /home/sshukla7/.local/lib/python3.9/site-packages (0.5.1)
Requirement already satisfied: pyarrow!=4.0.0,>=3.0.0 in /home/sshukla7/.local/lib/python3.9/site-packages (from datasets) (11.0.0)
Requirement already satisfied: requests>=2.19.0 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from datasets) (2.27.1)
Requirement already satisfied: packaging in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from datasets) (21.3)
Requirement already satisfied: pandas in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from datasets) (1.3.5)
Requirement already satisfied: numpy>=1.17 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from datasets) (1.22.3)
Requirement already satisfied: huggingface-hub<1.0.0,>=0.1.0 in /home/sshukla7/.local/lib/python3.9/site-packages (from datasets) (0.13.3)
Requirement already satisfied: aiohttp in /home/sshukla7/.local/lib/python3.9/site-packages (from datasets) (3.8.4)
Requirement already satisfied: dill in /home/sshukla7/.local/lib/python3.9/site-packages (from datasets) (0.3.6)
Requirement already satisfied: xxhash in /home/sshukla7/.local/lib/python3.9/site-packages (from datasets) (3.2.0)
Requirement already satisfied: fsspec[http]>=2021.05.0 in /home/sshukla7/.local/lib/python3.9/site-packages (from datasets) (2023.3.0)
Requirement already satisfied: multiprocess in /home/sshukla7/.local/lib/python3.9/site-packages (from datasets) (0.70.14)
Requirement already satisfied: tqdm>=4.62.1 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from datasets) (4.63.1)
Requirement already satisfied: responses<0.19 in /home/sshukla7/.local/lib/python3.9/site-packages (from datasets) (0.18.0)
Requirement already satisfied: tokenizers!=0.11.3,>=0.11.1 in /home/sshukla7/.local/lib/python3.9/site-packages (from transformers) (0.13.2)
Requirement already satisfied: regex!=2019.12.17 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from transformers) (2022.3.15)
Requirement already satisfied: filelock in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from transformers) (3.6.0)
Requirement already satisfied: sacremoses in /home/sshukla7/.local/lib/python3.9/site-packages (from transformers) (0.0.53)
Requirement already satisfied: pyyaml>=5.1 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from transformers) (6.0)
Requirement already satisfied: torch>=1.4.0 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from accelerate) (1.12.1+cu113)
Requirement already satisfied: charset-normalizer<4.0,>=2.0 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from aiohttp->datasets) (2.0.12)
Requirement already satisfied: async-timeout<5.0,>=4.0.0a3 in /home/sshukla7/.local/lib/python3.9/site-packages (from aiohttp->datasets) (4.0.2)
Requirement already satisfied: yarl<2.0,>=1.0 in /home/sshukla7/.local/lib/python3.9/site-packages (from aiohttp->datasets) (1.8.2)
Requirement already satisfied: aiosignal>=1.1.2 in /home/sshukla7/.local/lib/python3.9/site-packages (from aiohttp->datasets) (1.3.1)
Requirement already satisfied: multidict<7.0,>=4.5 in /home/sshukla7/.local/lib/python3.9/site-packages (from aiohttp->datasets) (6.0.4)
Requirement already satisfied: frozenlist>=1.1.1 in /home/sshukla7/.local/lib/python3.9/site-packages (from aiohttp->datasets) (1.3.3)
Requirement already satisfied: attrs>=17.3.0 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from aiohttp->datasets) (21.4.0)
Requirement already satisfied: typing-extensions>=3.7.4.3 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from huggingface-hub<1.0.0,>=0.1.0->datasets) (4.1.1)
Requirement already satisfied: pyparsing!=3.0.5,>=2.0.2 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from packaging->datasets) (3.0.7)
Requirement already satisfied: idna<4,>=2.5 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from requests>=2.19.0->datasets) (3.3)
Requirement already satisfied: certifi>=2017.4.17 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from requests>=2.19.0->datasets) (2021.10.8)
Requirement already satisfied: urllib3<1.27,>=1.21.1 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from requests>=2.19.0->datasets) (1.26.9)
Requirement already satisfied: python-dateutil>=2.7.3 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from pandas->datasets) (2.8.1)
Requirement already satisfied: pytz>=2017.3 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from pandas->datasets) (2019.3)
Requirement already satisfied: click in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from sacremoses->transformers) (8.0.4)
Requirement already satisfied: six in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from sacremoses->transformers) (1.16.0)
Requirement already satisfied: joblib in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from sacremoses->transformers) (1.1.0)
04/04/2023 18:11:32 - INFO - __main__ -   Distributed environment: NO
Num processes: 1
Process index: 0
Local process index: 0
Device: cuda
Use FP16 precision: False

04/04/2023 18:11:32 - WARNING - __main__ -   Namespace(dataset_name='xsum', dataset_config_name='3.0.0', train_file=None, validation_file=None, ignore_pad_token_for_loss=True, max_source_length=1024, source_prefix=None, preprocessing_num_workers=None, overwrite_cache=None, max_target_length=128, val_max_target_length=None, pad_to_max_length=False, model_name_or_path='morenolq/bart-base-xsum', config_name=None, tokenizer_name=None, text_column=None, summary_column=None, use_slow_tokenizer=False, per_device_train_batch_size=16, per_device_eval_batch_size=4, learning_rate=3e-05, weight_decay=0.0, num_train_epochs=20, max_train_steps=None, gradient_accumulation_steps=2, lr_scheduler_type=<SchedulerType.LINEAR: 'linear'>, warmup_ratio=0.05, output_dir='./output_xsum/8_8_6_6_20_3e-05_fp16', seed=28, model_type=None, teacher_model='morenolq/bart-base-xsum', student_model='morenolq/bart-base-xsum', pred_distill=True, intermediate_distill=True, weight_bits=8, input_bits=8, clip_val=2.5, length_penalty=1.0, max_length=62, min_length=11, num_beams=6, do_train=True, do_test=True, test_teacher=False, distill_encoder=6, distill_decoder=6, log_steps=20, local_rank=0, weighted=False, new_distill_map=False, task_weight=1, logits_weight=1, hid_weight=1)
04/04/2023 18:11:34 - WARNING - datasets.builder -   Using custom data configuration 3.0.0
04/04/2023 18:11:34 - WARNING - datasets.builder -   Reusing dataset xsum (/home/sshukla7/.cache/huggingface/datasets/xsum/3.0.0/1.2.0/32c23220eadddb1149b16ed2e9430a05293768cfffbdfd151058697d4c11f934)
init quantize emb
04/04/2023 18:11:42 - WARNING - datasets.fingerprint -   Parameter 'function'=<function main.<locals>.preprocess_function at 0x7f471087cee0> of the transform datasets.arrow_dataset.Dataset._map_single couldn't be hashed properly, a random hash was used instead. Make sure your transforms and parameters are serializable with pickle or dill for the dataset fingerprinting and caching to work. If you reuse this transform, the caching mechanism will consider it to be different from the previous calls and recompute everything. This warning is only showed once. Subsequent hashing failures won't be showed.
datasets size, train: 204045, validate: 11332, test: 11334
04/04/2023 18:12:07 - INFO - __main__ -   Sample 73114 of the training set: {'input_ids': [0, 894, 26, 22, 8585, 18, 117, 12818, 21692, 113, 71, 294, 18, 17680, 1818, 7, 2451, 10, 16192, 227, 1854, 18, 884, 8, 5, 1859, 18529, 4, 50118, 113, 100, 300, 88, 10, 5674, 14, 38, 4395, 75, 33, 8, 38, 34797, 62, 60, 37, 26, 23, 10, 433, 7900, 11, 663, 4, 50118, 113, 100, 74, 1394, 3334, 13, 5450, 108, 21473, 60, 37, 355, 4, 50118, 894, 21, 1238, 9, 145, 29401, 7, 8609, 8, 13903, 7149, 4, 50118, 894, 174, 1865, 23, 10, 735, 446, 340, 1019, 15, 302, 14, 16423, 22, 7325, 45, 634, 1123, 15, 39, 308, 82, 5, 276, 169, 14, 6331, 12186, 646, 15335, 742, 16, 608, 845, 50118, 10980, 12954, 56, 57, 7745, 3009, 798, 18, 323, 13, 3085, 270, 13524, 1076, 12, 15844, 6, 54, 16, 1238, 9, 6627, 10, 4747, 2398, 908, 656, 42, 353, 14, 314, 8572, 82, 1462, 4, 50118, 12582, 29370, 56, 2031, 111, 20192, 50, 8512, 50118, 7608, 473, 961, 489, 442, 12281, 17941, 116, 50118, 4148, 307, 662, 6, 5, 1228, 2971, 26, 39, 1450, 56, 16573, 31, 270, 807, 140, 18, 485, 2163, 6, 61, 1165, 6827, 7, 5, 3986, 4847, 1123, 908, 19, 10, 9135, 4379, 2506, 8, 10, 9526, 19, 1111, 270, 7030, 12883, 4, 50118, 113, 4148, 10, 2038, 672, 24, 18, 6770, 142, 38, 206, 38, 348, 905, 5, 394, 159, 60, 37, 26, 23, 10, 188, 1090, 783, 7900, 15, 427, 140, 18, 78, 727, 360, 4, 50118, 1708, 39, 1450, 6, 61, 376, 148, 5, 4586, 3241, 9, 7124, 2137, 6, 6246, 804, 10279, 8, 1519, 7, 3438, 123, 31, 39, 735, 446, 618, 4, 50118, 133, 7896, 3848, 824, 8, 1557, 5337, 8239, 9560, 258, 373, 15, 427, 140, 7, 668, 123, 150, 103, 9923, 427, 12954, 13, 5056, 7, 11772, 7376, 25, 22, 32139, 43328, 7872, 845, 50118, 113, 40671, 37, 16, 2686, 13, 5, 270, 6, 50, 5, 270, 197, 33, 684, 357, 87, 7, 6198, 123, 60, 79, 26, 11, 10, 445, 4, 2], 'attention_mask': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'labels': [0, 15725, 446, 977, 1863, 4640, 12954, 34, 26, 39, 821, 17459, 59, 32437, 16423, 45, 634, 4747, 2398, 21, 22, 833, 1178, 26797, 868, 8, 2851, 39438, 845, 2]}.
Yes, cuda is available, Found device: NVIDIA A100-SXM-80GB, n_gpu: 1
04/04/2023 18:12:11 - INFO - __main__ -   ***** Running training *****
04/04/2023 18:12:11 - INFO - __main__ -     Num examples = 204045
04/04/2023 18:12:11 - INFO - __main__ -     Num Epochs = 20
04/04/2023 18:12:11 - INFO - __main__ -     Instantaneous batch size per device = 16
04/04/2023 18:12:11 - INFO - __main__ -     Total train batch size (w. parallel, distributed & accumulation) = 32
04/04/2023 18:12:11 - INFO - __main__ -     Gradient Accumulation steps = 2
04/04/2023 18:12:11 - INFO - __main__ -     Total optimization steps = 127540
04/04/2023 18:12:11 - INFO - __main__ -     student encoder layers = 6
04/04/2023 18:12:11 - INFO - __main__ -     student decoder layers = 6
04/04/2023 18:12:11 - INFO - __main__ -     student encoder layers [0, 1, 2, 3, 4, 5] is mapped with teacher encoder layers [0, 1, 2, 3, 4, 5]
04/04/2023 18:12:11 - INFO - __main__ -     student decoder layers [0, 1, 2, 3, 4, 5] is mapped with teacher decoder layers [0, 1, 2, 3, 4, 5]
04/04/2023 21:50:35 - INFO - __main__ -   evaluation result: {'eval/rouge1': 40.4964, 'eval/rouge2': 17.55, 'eval/rougeL': 32.5371, 'eval/rougeLsum': 32.5273} 
