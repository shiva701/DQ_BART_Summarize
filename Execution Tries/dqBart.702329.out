Defaulting to user installation because normal site-packages is not writeable
Requirement already satisfied: pip in /home/sshukla7/.local/lib/python3.9/site-packages (23.0.1)
Defaulting to user installation because normal site-packages is not writeable
Requirement already satisfied: transformers==4.17.0 in /home/sshukla7/.local/lib/python3.9/site-packages (from -r requirements.txt (line 1)) (4.17.0)
Requirement already satisfied: datasets==1.18.4 in /home/sshukla7/.local/lib/python3.9/site-packages (from -r requirements.txt (line 2)) (1.18.4)
Requirement already satisfied: sacrebleu==2.0 in /home/sshukla7/.local/lib/python3.9/site-packages (from -r requirements.txt (line 3)) (2.0.0)
Requirement already satisfied: wandb in /home/sshukla7/.local/lib/python3.9/site-packages (from -r requirements.txt (line 4)) (0.14.0)
Requirement already satisfied: nltk in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from -r requirements.txt (line 5)) (3.6.7)
Requirement already satisfied: accelerate==0.5.1 in /home/sshukla7/.local/lib/python3.9/site-packages (from -r requirements.txt (line 6)) (0.5.1)
Requirement already satisfied: tensorboard in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from -r requirements.txt (line 7)) (2.8.0)
Requirement already satisfied: setuptools<50 in /home/sshukla7/.local/lib/python3.9/site-packages (from -r requirements.txt (line 8)) (49.6.0)
Requirement already satisfied: rouge_score in /home/sshukla7/.local/lib/python3.9/site-packages (from -r requirements.txt (line 9)) (0.1.2)
Requirement already satisfied: packaging>=20.0 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from transformers==4.17.0->-r requirements.txt (line 1)) (21.3)
Requirement already satisfied: sacremoses in /home/sshukla7/.local/lib/python3.9/site-packages (from transformers==4.17.0->-r requirements.txt (line 1)) (0.0.53)
Requirement already satisfied: tokenizers!=0.11.3,>=0.11.1 in /home/sshukla7/.local/lib/python3.9/site-packages (from transformers==4.17.0->-r requirements.txt (line 1)) (0.13.2)
Requirement already satisfied: tqdm>=4.27 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from transformers==4.17.0->-r requirements.txt (line 1)) (4.63.1)
Requirement already satisfied: filelock in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from transformers==4.17.0->-r requirements.txt (line 1)) (3.6.0)
Requirement already satisfied: huggingface-hub<1.0,>=0.1.0 in /home/sshukla7/.local/lib/python3.9/site-packages (from transformers==4.17.0->-r requirements.txt (line 1)) (0.13.3)
Requirement already satisfied: pyyaml>=5.1 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from transformers==4.17.0->-r requirements.txt (line 1)) (6.0)
Requirement already satisfied: regex!=2019.12.17 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from transformers==4.17.0->-r requirements.txt (line 1)) (2022.3.15)
Requirement already satisfied: requests in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from transformers==4.17.0->-r requirements.txt (line 1)) (2.27.1)
Requirement already satisfied: numpy>=1.17 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from transformers==4.17.0->-r requirements.txt (line 1)) (1.22.3)
Requirement already satisfied: xxhash in /home/sshukla7/.local/lib/python3.9/site-packages (from datasets==1.18.4->-r requirements.txt (line 2)) (3.2.0)
Requirement already satisfied: multiprocess in /home/sshukla7/.local/lib/python3.9/site-packages (from datasets==1.18.4->-r requirements.txt (line 2)) (0.70.14)
Requirement already satisfied: fsspec[http]>=2021.05.0 in /home/sshukla7/.local/lib/python3.9/site-packages (from datasets==1.18.4->-r requirements.txt (line 2)) (2023.3.0)
Requirement already satisfied: pandas in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from datasets==1.18.4->-r requirements.txt (line 2)) (1.3.5)
Requirement already satisfied: dill in /home/sshukla7/.local/lib/python3.9/site-packages (from datasets==1.18.4->-r requirements.txt (line 2)) (0.3.6)
Requirement already satisfied: responses<0.19 in /home/sshukla7/.local/lib/python3.9/site-packages (from datasets==1.18.4->-r requirements.txt (line 2)) (0.18.0)
Requirement already satisfied: pyarrow!=4.0.0,>=3.0.0 in /home/sshukla7/.local/lib/python3.9/site-packages (from datasets==1.18.4->-r requirements.txt (line 2)) (11.0.0)
Requirement already satisfied: aiohttp in /home/sshukla7/.local/lib/python3.9/site-packages (from datasets==1.18.4->-r requirements.txt (line 2)) (3.8.4)
Requirement already satisfied: tabulate>=0.8.9 in /home/sshukla7/.local/lib/python3.9/site-packages (from sacrebleu==2.0->-r requirements.txt (line 3)) (0.9.0)
Requirement already satisfied: portalocker in /home/sshukla7/.local/lib/python3.9/site-packages (from sacrebleu==2.0->-r requirements.txt (line 3)) (2.7.0)
Requirement already satisfied: colorama in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from sacrebleu==2.0->-r requirements.txt (line 3)) (0.4.4)
Requirement already satisfied: torch>=1.4.0 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from accelerate==0.5.1->-r requirements.txt (line 6)) (1.12.1+cu113)
Requirement already satisfied: psutil>=5.0.0 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from wandb->-r requirements.txt (line 4)) (5.9.0)
Requirement already satisfied: pathtools in /home/sshukla7/.local/lib/python3.9/site-packages (from wandb->-r requirements.txt (line 4)) (0.1.2)
Requirement already satisfied: docker-pycreds>=0.4.0 in /home/sshukla7/.local/lib/python3.9/site-packages (from wandb->-r requirements.txt (line 4)) (0.4.0)
Requirement already satisfied: appdirs>=1.4.3 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from wandb->-r requirements.txt (line 4)) (1.4.4)
Requirement already satisfied: protobuf!=4.21.0,<5,>=3.15.0 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from wandb->-r requirements.txt (line 4)) (3.19.4)
Requirement already satisfied: GitPython!=3.1.29,>=1.0.0 in /home/sshukla7/.local/lib/python3.9/site-packages (from wandb->-r requirements.txt (line 4)) (3.1.31)
Requirement already satisfied: Click!=8.0.0,>=7.0 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from wandb->-r requirements.txt (line 4)) (8.0.4)
Requirement already satisfied: sentry-sdk>=1.0.0 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from wandb->-r requirements.txt (line 4)) (1.5.8)
Requirement already satisfied: typing-extensions in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from wandb->-r requirements.txt (line 4)) (4.1.1)
Requirement already satisfied: setproctitle in /home/sshukla7/.local/lib/python3.9/site-packages (from wandb->-r requirements.txt (line 4)) (1.3.2)
Requirement already satisfied: joblib in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from nltk->-r requirements.txt (line 5)) (1.1.0)
Requirement already satisfied: absl-py>=0.4 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from tensorboard->-r requirements.txt (line 7)) (1.0.0)
Requirement already satisfied: grpcio>=1.24.3 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from tensorboard->-r requirements.txt (line 7)) (1.44.0)
Requirement already satisfied: tensorboard-data-server<0.7.0,>=0.6.0 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from tensorboard->-r requirements.txt (line 7)) (0.6.1)
Requirement already satisfied: wheel>=0.26 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from tensorboard->-r requirements.txt (line 7)) (0.37.1)
Requirement already satisfied: google-auth<3,>=1.6.3 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from tensorboard->-r requirements.txt (line 7)) (1.35.0)
Requirement already satisfied: werkzeug>=0.11.15 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from tensorboard->-r requirements.txt (line 7)) (2.0.3)
Requirement already satisfied: markdown>=2.6.8 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from tensorboard->-r requirements.txt (line 7)) (3.3.6)
Requirement already satisfied: tensorboard-plugin-wit>=1.6.0 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from tensorboard->-r requirements.txt (line 7)) (1.8.1)
Requirement already satisfied: google-auth-oauthlib<0.5,>=0.4.1 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from tensorboard->-r requirements.txt (line 7)) (0.4.6)
Requirement already satisfied: six>=1.14.0 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from rouge_score->-r requirements.txt (line 9)) (1.16.0)
Requirement already satisfied: yarl<2.0,>=1.0 in /home/sshukla7/.local/lib/python3.9/site-packages (from aiohttp->datasets==1.18.4->-r requirements.txt (line 2)) (1.8.2)
Requirement already satisfied: charset-normalizer<4.0,>=2.0 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from aiohttp->datasets==1.18.4->-r requirements.txt (line 2)) (2.0.12)
Requirement already satisfied: attrs>=17.3.0 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from aiohttp->datasets==1.18.4->-r requirements.txt (line 2)) (21.4.0)
Requirement already satisfied: multidict<7.0,>=4.5 in /home/sshukla7/.local/lib/python3.9/site-packages (from aiohttp->datasets==1.18.4->-r requirements.txt (line 2)) (6.0.4)
Requirement already satisfied: aiosignal>=1.1.2 in /home/sshukla7/.local/lib/python3.9/site-packages (from aiohttp->datasets==1.18.4->-r requirements.txt (line 2)) (1.3.1)
Requirement already satisfied: async-timeout<5.0,>=4.0.0a3 in /home/sshukla7/.local/lib/python3.9/site-packages (from aiohttp->datasets==1.18.4->-r requirements.txt (line 2)) (4.0.2)
Requirement already satisfied: frozenlist>=1.1.1 in /home/sshukla7/.local/lib/python3.9/site-packages (from aiohttp->datasets==1.18.4->-r requirements.txt (line 2)) (1.3.3)
Requirement already satisfied: gitdb<5,>=4.0.1 in /home/sshukla7/.local/lib/python3.9/site-packages (from GitPython!=3.1.29,>=1.0.0->wandb->-r requirements.txt (line 4)) (4.0.10)
Requirement already satisfied: rsa<5,>=3.1.4 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from google-auth<3,>=1.6.3->tensorboard->-r requirements.txt (line 7)) (4.8)
Requirement already satisfied: cachetools<5.0,>=2.0.0 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from google-auth<3,>=1.6.3->tensorboard->-r requirements.txt (line 7)) (4.2.4)
Requirement already satisfied: pyasn1-modules>=0.2.1 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from google-auth<3,>=1.6.3->tensorboard->-r requirements.txt (line 7)) (0.2.8)
Requirement already satisfied: requests-oauthlib>=0.7.0 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from google-auth-oauthlib<0.5,>=0.4.1->tensorboard->-r requirements.txt (line 7)) (1.3.1)
Requirement already satisfied: importlib-metadata>=4.4 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from markdown>=2.6.8->tensorboard->-r requirements.txt (line 7)) (4.11.3)
Requirement already satisfied: pyparsing!=3.0.5,>=2.0.2 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from packaging>=20.0->transformers==4.17.0->-r requirements.txt (line 1)) (3.0.7)
Requirement already satisfied: idna<4,>=2.5 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from requests->transformers==4.17.0->-r requirements.txt (line 1)) (3.3)
Requirement already satisfied: certifi>=2017.4.17 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from requests->transformers==4.17.0->-r requirements.txt (line 1)) (2021.10.8)
Requirement already satisfied: urllib3<1.27,>=1.21.1 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from requests->transformers==4.17.0->-r requirements.txt (line 1)) (1.26.9)
Requirement already satisfied: pytz>=2017.3 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from pandas->datasets==1.18.4->-r requirements.txt (line 2)) (2019.3)
Requirement already satisfied: python-dateutil>=2.7.3 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from pandas->datasets==1.18.4->-r requirements.txt (line 2)) (2.8.1)
Requirement already satisfied: smmap<6,>=3.0.1 in /home/sshukla7/.local/lib/python3.9/site-packages (from gitdb<5,>=4.0.1->GitPython!=3.1.29,>=1.0.0->wandb->-r requirements.txt (line 4)) (5.0.0)
Requirement already satisfied: zipp>=0.5 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from importlib-metadata>=4.4->markdown>=2.6.8->tensorboard->-r requirements.txt (line 7)) (3.7.0)
Requirement already satisfied: pyasn1<0.5.0,>=0.4.6 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from pyasn1-modules>=0.2.1->google-auth<3,>=1.6.3->tensorboard->-r requirements.txt (line 7)) (0.4.8)
Requirement already satisfied: oauthlib>=3.0.0 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from requests-oauthlib>=0.7.0->google-auth-oauthlib<0.5,>=0.4.1->tensorboard->-r requirements.txt (line 7)) (3.2.0)
Defaulting to user installation because normal site-packages is not writeable
Requirement already satisfied: datasets in /home/sshukla7/.local/lib/python3.9/site-packages (1.18.4)
Requirement already satisfied: transformers in /home/sshukla7/.local/lib/python3.9/site-packages (4.17.0)
Requirement already satisfied: accelerate in /home/sshukla7/.local/lib/python3.9/site-packages (0.5.1)
Requirement already satisfied: pandas in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from datasets) (1.3.5)
Requirement already satisfied: pyarrow!=4.0.0,>=3.0.0 in /home/sshukla7/.local/lib/python3.9/site-packages (from datasets) (11.0.0)
Requirement already satisfied: huggingface-hub<1.0.0,>=0.1.0 in /home/sshukla7/.local/lib/python3.9/site-packages (from datasets) (0.13.3)
Requirement already satisfied: dill in /home/sshukla7/.local/lib/python3.9/site-packages (from datasets) (0.3.6)
Requirement already satisfied: requests>=2.19.0 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from datasets) (2.27.1)
Requirement already satisfied: responses<0.19 in /home/sshukla7/.local/lib/python3.9/site-packages (from datasets) (0.18.0)
Requirement already satisfied: xxhash in /home/sshukla7/.local/lib/python3.9/site-packages (from datasets) (3.2.0)
Requirement already satisfied: multiprocess in /home/sshukla7/.local/lib/python3.9/site-packages (from datasets) (0.70.14)
Requirement already satisfied: fsspec[http]>=2021.05.0 in /home/sshukla7/.local/lib/python3.9/site-packages (from datasets) (2023.3.0)
Requirement already satisfied: numpy>=1.17 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from datasets) (1.22.3)
Requirement already satisfied: packaging in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from datasets) (21.3)
Requirement already satisfied: tqdm>=4.62.1 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from datasets) (4.63.1)
Requirement already satisfied: aiohttp in /home/sshukla7/.local/lib/python3.9/site-packages (from datasets) (3.8.4)
Requirement already satisfied: sacremoses in /home/sshukla7/.local/lib/python3.9/site-packages (from transformers) (0.0.53)
Requirement already satisfied: tokenizers!=0.11.3,>=0.11.1 in /home/sshukla7/.local/lib/python3.9/site-packages (from transformers) (0.13.2)
Requirement already satisfied: filelock in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from transformers) (3.6.0)
Requirement already satisfied: pyyaml>=5.1 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from transformers) (6.0)
Requirement already satisfied: regex!=2019.12.17 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from transformers) (2022.3.15)
Requirement already satisfied: torch>=1.4.0 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from accelerate) (1.12.1+cu113)
Requirement already satisfied: aiosignal>=1.1.2 in /home/sshukla7/.local/lib/python3.9/site-packages (from aiohttp->datasets) (1.3.1)
Requirement already satisfied: multidict<7.0,>=4.5 in /home/sshukla7/.local/lib/python3.9/site-packages (from aiohttp->datasets) (6.0.4)
Requirement already satisfied: charset-normalizer<4.0,>=2.0 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from aiohttp->datasets) (2.0.12)
Requirement already satisfied: yarl<2.0,>=1.0 in /home/sshukla7/.local/lib/python3.9/site-packages (from aiohttp->datasets) (1.8.2)
Requirement already satisfied: frozenlist>=1.1.1 in /home/sshukla7/.local/lib/python3.9/site-packages (from aiohttp->datasets) (1.3.3)
Requirement already satisfied: attrs>=17.3.0 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from aiohttp->datasets) (21.4.0)
Requirement already satisfied: async-timeout<5.0,>=4.0.0a3 in /home/sshukla7/.local/lib/python3.9/site-packages (from aiohttp->datasets) (4.0.2)
Requirement already satisfied: typing-extensions>=3.7.4.3 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from huggingface-hub<1.0.0,>=0.1.0->datasets) (4.1.1)
Requirement already satisfied: pyparsing!=3.0.5,>=2.0.2 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from packaging->datasets) (3.0.7)
Requirement already satisfied: certifi>=2017.4.17 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from requests>=2.19.0->datasets) (2021.10.8)
Requirement already satisfied: urllib3<1.27,>=1.21.1 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from requests>=2.19.0->datasets) (1.26.9)
Requirement already satisfied: idna<4,>=2.5 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from requests>=2.19.0->datasets) (3.3)
Requirement already satisfied: pytz>=2017.3 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from pandas->datasets) (2019.3)
Requirement already satisfied: python-dateutil>=2.7.3 in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from pandas->datasets) (2.8.1)
Requirement already satisfied: six in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from sacremoses->transformers) (1.16.0)
Requirement already satisfied: click in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from sacremoses->transformers) (8.0.4)
Requirement already satisfied: joblib in /opt/sw/spack/apps/linux-rhel8-x86_64_v2/gcc-10.3.0/python-3.9.9-jh/lib/python3.9/site-packages (from sacremoses->transformers) (1.1.0)
04/03/2023 15:02:42 - INFO - __main__ -   Distributed environment: NO
Num processes: 1
Process index: 0
Local process index: 0
Device: cuda
Use FP16 precision: False

04/03/2023 15:02:42 - WARNING - __main__ -   Namespace(dataset_name='cnn_dailymail', dataset_config_name='3.0.0', train_file=None, validation_file=None, ignore_pad_token_for_loss=True, max_source_length=1024, source_prefix=None, preprocessing_num_workers=None, overwrite_cache=None, max_target_length=128, val_max_target_length=None, pad_to_max_length=False, model_name_or_path='ainize/bart-base-cnn', config_name=None, tokenizer_name=None, text_column=None, summary_column=None, use_slow_tokenizer=False, per_device_train_batch_size=128, per_device_eval_batch_size=4, learning_rate=3e-05, weight_decay=0.0, num_train_epochs=20, max_train_steps=None, gradient_accumulation_steps=2, lr_scheduler_type=<SchedulerType.LINEAR: 'linear'>, warmup_ratio=0.05, output_dir='./output_cnn_dailymail/8_8_6_6_20_3e-05_fp16', seed=28, model_type=None, teacher_model='ainize/bart-base-cnn', student_model='ainize/bart-base-cnn', pred_distill=True, intermediate_distill=True, weight_bits=8, input_bits=8, clip_val=2.5, length_penalty=2.0, max_length=142, min_length=56, num_beams=4, do_train=True, do_test=True, test_teacher=False, distill_encoder=6, distill_decoder=6, log_steps=20, local_rank=0, weighted=False, new_distill_map=False, task_weight=1, logits_weight=1, hid_weight=1)
04/03/2023 15:02:44 - WARNING - datasets.builder -   Reusing dataset cnn_dailymail (/home/sshukla7/.cache/huggingface/datasets/cnn_dailymail/3.0.0/3.0.0/3cb851bf7cf5826e45d49db2863f627cba583cbc32342df7349dfe6c38060234)
init quantize emb
04/03/2023 15:02:52 - WARNING - datasets.fingerprint -   Parameter 'function'=<function main.<locals>.preprocess_function at 0x7f84648178b0> of the transform datasets.arrow_dataset.Dataset._map_single couldn't be hashed properly, a random hash was used instead. Make sure your transforms and parameters are serializable with pickle or dill for the dataset fingerprinting and caching to work. If you reuse this transform, the caching mechanism will consider it to be different from the previous calls and recompute everything. This warning is only showed once. Subsequent hashing failures won't be showed.
datasets size, train: 5000, validate: 5000, test: 5000
04/03/2023 15:03:54 - INFO - __main__ -   Sample 1372 of the training set: {'input_ids': [0, 1640, 16256, 43, 480, 20929, 3338, 16, 10, 3159, 631, 11, 2414, 35, 83, 232, 2234, 19921, 54, 202, 1074, 19, 39, 1041, 8, 10, 5395, 3346, 54, 16, 45, 6023, 7, 1100, 5, 2274, 9, 7503, 452, 4, 3338, 29143, 758, 9114, 1282, 77, 37, 21, 95, 601, 6, 1298, 10, 4334, 5279, 23, 5, 3336, 3100, 11, 11198, 11, 4482, 4, 978, 883, 6, 37, 3106, 5, 305, 3813, 623, 5737, 15565, 1334, 4301, 1270, 6, 7194, 136, 1206, 118, 2529, 4932, 7165, 118, 11, 188, 469, 11, 392, 4, 125, 4520, 4666, 8, 380, 1947, 2220, 75, 16573, 5, 2143, 31, 12160, 6, 41, 542, 34730, 1139, 11, 9815, 1156, 4, 91, 202, 1074, 6, 8, 13, 5, 144, 233, 6, 7717, 6, 11, 39, 8994, 4, 22, 100, 437, 98, 593, 19, 127, 284, 1666, 127, 13404, 393, 2039, 41, 13836, 1032, 50, 10, 2038, 1032, 6, 127, 11992, 18, 5, 276, 6, 51, 348, 460, 57, 19, 162, 14, 18, 596, 38, 33, 98, 203, 2098, 13, 106, 60, 3338, 174, 3480, 4, 3338, 1834, 7, 3480, 18, 23000, 9389, 165, 71, 39, 380, 1032, 11, 188, 469, 6, 59, 39, 301, 25, 10, 1612, 397, 6, 1089, 3346, 8, 774, 1421, 4, 3480, 35, 2612, 109, 47, 657, 9114, 116, 20929, 3338, 35, 85, 2653, 101, 184, 6, 190, 77, 38, 1149, 11, 5, 3758, 4, 287, 1010, 25, 38, 1656, 88, 143, 6545, 11, 5, 232, 38, 619, 23, 184, 4, 38, 216, 960, 6, 38, 216, 99, 7, 109, 4, 85, 95, 2653, 98, 3473, 4, 38, 64, 109, 99, 38, 236, 89, 4, 85, 2653, 190, 55, 3473, 87, 3051, 88, 127, 308, 790, 8, 127, 308, 8140, 4, 280, 18, 141, 203, 38, 657, 9114, 4, 38, 101, 7, 12043, 77, 38, 437, 11, 5, 9114, 3758, 131, 38, 101, 7, 311, 2078, 6, 476, 8, 41294, 12367, 4, 85, 18, 41, 1808, 6, 82, 240, 7, 192, 646, 405, 25, 742, 14, 6, 45, 25, 10, 4153, 2414, 6, 8, 77, 38, 213, 88, 5, 3758, 7, 2581, 951, 24, 18, 142, 51, 214, 667, 7, 2581, 162, 4, 280, 18, 5, 129, 1219, 38, 478, 106, 124, 4, 3480, 35, 1832, 47, 2914, 10, 430, 2056, 25, 5, 1032, 8369, 116, 14530, 35, 38, 4940, 2914, 10, 430, 2056, 4, 85, 18, 101, 77, 38, 437, 11, 5, 6545, 38, 437, 727, 135, 89, 1666, 24, 18, 101, 23434, 20366, 6, 38, 437, 95, 608, 24, 6, 313, 6, 127, 809, 18, 95, 442, 162, 109, 3046, 4, 3421, 2012, 164, 9992, 8955, 5, 1032, 6, 2085, 237, 360, 137, 5, 1032, 6, 86, 95, 6897, 4, 3480, 35, 1832, 47, 206, 82, 356, 13, 10, 1015, 696, 77, 47, 1032, 116, 14530, 35, 8374, 10, 3346, 8, 145, 10, 9246, 10, 319, 9, 82, 32, 164, 7, 836, 14, 696, 62, 4, 38, 437, 4731, 5, 3794, 13, 1444, 8, 1752, 6, 38, 437, 2602, 7, 28, 1089, 8, 1089, 9246, 6, 8, 38, 206, 89, 18, 10, 319, 9, 82, 6, 3346, 82, 6, 95, 101, 162, 4, 407, 6, 77, 47, 109, 120, 10, 319, 9, 82, 646, 34982, 59, 742, 4952, 8, 2682, 101, 14, 6, 24, 18, 129, 10, 182, 650, 3164, 4, 345, 18, 10, 2671, 2170, 66, 89, 8, 38, 236, 82, 7, 1407, 127, 18424, 8, 109, 99, 38, 437, 608, 4, 3480, 35, 1336, 473, 110, 3975, 244, 47, 116, 14530, 35, 1308, 3975, 4719, 162, 14083, 8, 4719, 127, 1730, 15, 5, 1255, 4, 38, 10745, 8, 38, 109, 383, 9638, 4, 85, 2029, 162, 2707, 77, 38, 213, 11, 5, 3758, 4, 38, 216, 38, 437, 45, 15, 127, 308, 6, 38, 348, 300, 1840, 15, 127, 526, 25, 157, 6, 1840, 18, 1903, 162, 6, 1840, 18, 164, 7, 492, 162, 14, 8725, 2707, 7, 213, 11, 89, 8, 339, 5, 1032, 4, 14408, 11, 5, 3758, 16, 10, 20100, 317, 6, 24, 18, 95, 47, 8, 110, 5254, 6, 117, 65, 1493, 6, 98, 47, 216, 39704, 77, 47, 33, 14, 244, 24, 817, 10, 2232, 2249, 4, 85, 2029, 47, 98, 203, 2123, 4, 3480, 35, 1832, 47, 2128, 95, 236, 7, 28, 10, 19921, 396, 5, 2274, 116, 14530, 35, 497, 498, 38, 341, 7, 206, 7, 2185, 6, 38, 348, 300, 10, 319, 9, 1164, 15, 162, 6, 53, 38, 437, 1372, 19, 24, 4, 1806, 192, 162, 25, 10, 9246, 3346, 1089, 7251, 4, 38, 437, 2051, 19, 14, 8, 145, 10, 774, 1421, 4, 3480, 35, 653, 473, 24, 1266, 7, 47, 7, 28, 450, 25, 10, 774, 1421, 116, 14530, 35, 85, 18, 2579, 6, 38, 206, 38, 437, 1153, 5, 129, 3102, 3346, 774, 1421, 11, 1444, 6, 89, 18, 117, 97, 3346, 6, 9246, 6, 1362, 50, 3046, 774, 1421, 11, 5, 247, 1666, 14, 473, 342, 1164, 15, 47, 53, 38, 437, 129, 608, 99, 38, 657, 7, 109, 4, 38, 437, 10, 19921, 6, 38, 437, 10, 2340, 2173, 6, 38, 437, 393, 164, 7, 464, 117, 948, 141, 380, 38, 120, 4, 38, 437, 393, 164, 7, 28, 380, 12, 19279, 8, 38, 4157, 167, 54, 32, 4, 38, 393, 356, 159, 15, 1268, 8, 38, 581, 460, 1994, 7, 82, 6, 38, 348, 300, 86, 13, 127, 841, 1666, 190, 114, 38, 33, 7, 213, 66, 9, 127, 169, 7, 109, 24, 6, 38, 581, 185, 10, 2170, 6, 8, 38, 348, 57, 608, 14, 8, 2085, 14, 18, 5, 1219, 14, 1840, 2029, 162, 98, 203, 480, 8, 34, 576, 162, 98, 203, 480, 1282, 4, 3480, 35, 4820, 74, 47, 28, 114, 24, 3559, 75, 13, 9114, 116, 14530, 35, 38, 348, 300, 10, 319, 9, 964, 54, 58, 11, 334, 19, 162, 8, 51, 348, 551, 5, 1593, 2718, 8, 38, 206, 38, 74, 348, 551, 5, 1593, 2718, 19, 106, 4, 38, 74, 348, 2299, 1613, 5, 1593, 2718, 50, 2085, 202, 28, 19, 127, 1041, 4, 590, 5, 2098, 38, 33, 13, 106, 6, 51, 74, 348, 1682, 162, 15, 2], 'attention_mask': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], 'labels': [0, 10127, 853, 3338, 16, 10, 1089, 19921, 8, 305, 3813, 623, 5737, 15565, 1334, 4301, 2234, 479, 50118, 530, 4134, 1451, 470, 19921, 1206, 118, 2529, 4932, 7165, 118, 11, 78, 1032, 11, 5, 121, 4, 104, 4, 11, 392, 479, 50118, 39722, 8, 1179, 11, 12160, 6, 10, 1139, 11, 9815, 1156, 131, 202, 1074, 19, 284, 479, 50118, 30504, 995, 3346, 6, 37, 16, 2602, 9, 39, 284, 7788, 8, 2194, 25, 774, 1421, 479, 2]}.
Yes, cuda is available, Found device: NVIDIA A100-SXM-80GB, n_gpu: 1
04/03/2023 15:03:56 - INFO - __main__ -   ***** Running training *****
04/03/2023 15:03:56 - INFO - __main__ -     Num examples = 5000
04/03/2023 15:03:56 - INFO - __main__ -     Num Epochs = 20
04/03/2023 15:03:56 - INFO - __main__ -     Instantaneous batch size per device = 128
04/03/2023 15:03:56 - INFO - __main__ -     Total train batch size (w. parallel, distributed & accumulation) = 256
04/03/2023 15:03:56 - INFO - __main__ -     Gradient Accumulation steps = 2
04/03/2023 15:03:56 - INFO - __main__ -     Total optimization steps = 400
04/03/2023 15:03:56 - INFO - __main__ -     student encoder layers = 6
04/03/2023 15:03:56 - INFO - __main__ -     student decoder layers = 6
04/03/2023 15:03:56 - INFO - __main__ -     student encoder layers [0, 1, 2, 3, 4, 5] is mapped with teacher encoder layers [0, 1, 2, 3, 4, 5]
04/03/2023 15:03:56 - INFO - __main__ -     student decoder layers [0, 1, 2, 3, 4, 5] is mapped with teacher decoder layers [0, 1, 2, 3, 4, 5]
